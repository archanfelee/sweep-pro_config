#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/outputs.h>
#include <dt-bindings/zmk/mouse.h>

#define DEFAULT 0
#define NUM     1
#define SYM     2
#define FUN     3
#define MSE     4

#include "key-common.dtsi"

// mod-tap settings
&mt {
   flavor = "tap-preferred";
   tapping_term_ms = <200>;
};

// mouse move settings
#define MMV_U MOVE_VERT(-650)
#define MMV_D MOVE_VERT(650)
#define MMV_L MOVE_HOR(-650)
#define MMV_R MOVE_HOR(650)

&mmv {    
        time-to-max-speed-ms = <500>;
        acceleration-exponent=<1>;
};

// mouse wheel settings
#define MWH_U SCROLL_VERT(15)
#define MWH_D SCROLL_VERT(-15)
#define MWH_L SCROLL_HOR(-15)
#define MWH_R SCROLL_HOR(15)

&mwh {    
        time-to-max-speed-ms = <2000>;
        acceleration-exponent=<0>;
};

// keymap definition
/ { 

    keymap {
        compatible = "zmk,keymap";
                
     		default_layer {
            label = "CLMK";
			bindings = <
            	&kp Q     &kp W      &kp E      &kp R      &kp T         &kp Y     &kp U      &kp I      &kp O      &kp P
             	&lt SYM A &mt LALT S &mt LSFT D &mt LCTL F &kp G         &kp  H    &mt RCTL J &mt RSFT K &mt RALT L &lt SYM SEMI 
                &kp Z     &kp X      &kp C      &lt MSE V  &kp B         &kp N     &lt MSE M  &kp COMMA &kp DOT &kp FSLH
                &none  &none  &kp TAB  &lt NUM SPACE  &lt SYM RET         &lt NUM ESC &lt FUN BSPC &kp C_PLAY_PAUSE  &none   &none
         		>;
            sensor-bindings = <&inc_dec_kp RIGHT LEFT &inc_de_kp C_PREVIOUS C_NEXT>;
		    };

        number_layer {
            label = "NUM";
            bindings = <
                &kp UP  &kp LEFT  &kp DOWN    &kp RIGHT   &kp F4      &kp MINUS    &kp EQUAL  &kp LEFT_BRACKET  &kp RIGHT_BRACKET  &kp BACKSLASH
                &kp N1  &kp N2  &kp N3  &kp N4  &kp N5                &kp N6   &kp N7  &kp N8  &kp N9  &kp N0
                &kp EXCLAMATION  &kp QUESTION  &kp LESS_THAN   &kp GREATER_THAN   &spc3      &kp UNDERSCORE   &kp COLON  &kp LEFT_BRACE  &kp RIGHT_BRACE  &kp SINGLE_QUOTE
                           &none  &none  &trans  &trans  &trans      &kp K_APPLICATION     &trans  &trans  &none  &none
            >;
            sensor-bindings = <&inc_dec_kp PG_UP PG_DN &inc_dec_kp C_VOL_UP C_VOL_DN>;
        };

        symbol_layer {
            label = "SYM";
            bindings = <
                &none     &kp TILDE &kp LT    &kp GT   &kp PRCNT      &kp AMPS  &kp CARET  &kp HOME  &kp PAGE_UP  &none
                &kp C_VOL_UP &kp C_PREVIOUS &kp C_PLAY_PAUSE &kp C_NEXT &kp C_MUTE      &kp CARET &kp AMPS &kp STAR &kp LPAR &kp RPAR &mt
                &kp C_VOL_DN   &kp AT &kp HASH &kp DLLR &kp PRCNT       &kp HASH  &kp DLLR   &kp END  &kp PAGE_DOWN  &none  
                             &none  &none  &hello  &none  &none       &kp DELETE  &none  &encoder  &none  &none
            >;
            sensor-bindings = <&inc_dec_kp PG_UP PG_DN &inc_dec_kp C_VOL_UP C_VOL_DN>;
        };

        function_layer {
            label = "FUN";
            bindings = <
                &none  &kp F1  &kp F2  &kp F3  &none       &none &kp F4  &kp F5  &kp F6  &none
                &none  &kp F7  &kp F8  &kp F9  &none       &none &kp F10 &kp F11 &kp F12 &none
                &none  &none   &none   &none   &none       &none &none   &none   &none   &none
                &none  &none   &none   &none   &none       &none &none   &none   &none   &none
            >;
            sensor-bindings = <&inc_dec_kp PG_UP PG_DN &inc_dec_kp C_VOL_UP C_VOL_DN>;
        };
        
        mouse_layer {
            label = "MSE";
            bindings = <
                &bt BT_PRV  &bt BT_NXT       &mmv MMV_U  &none       &none       &none  &none       &mwh MWH_U  &none       &none
                &bt BT_CLR  &mmv MMV_L  &mmv MMV_D  &mmv MMV_R  &none       &none  &mwh MWH_L  &mwh MWH_D  &mwh MWH_R  &none
                &bt BT_SEL 0 &bt BT_SEL 1 &bt BT_SEL 2 &bt BT_SEL 3 &bt BT_SEL 4       &none  &none       &none       &none       &none
                &none  &none       &none       &none       &none       &none  &none       &none       &none       &none
            >;
            sensor-bindings = <&inc_dec_kp PG_UP PG_DN &inc_dec_kp C_VOL_UP C_VOL_DN>;
        };
   	};
};
